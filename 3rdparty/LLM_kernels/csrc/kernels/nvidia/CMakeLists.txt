# Copyright 2024 Tencent Inc.  All rights reserved.

add_subdirectory(gemm_wrapper)
add_subdirectory(embedding)
add_subdirectory(expand)
add_subdirectory(layernorm)
add_subdirectory(paged_attention)
add_subdirectory(rotary_embedding)
add_subdirectory(samplers)
add_subdirectory(add)
add_subdirectory(activation)
add_subdirectory(assemble_tokens_hidden)
add_subdirectory(cast)
add_subdirectory(asymmetric_gemm)
add_subdirectory(weight_only_batched_gemv)
add_subdirectory(mixture_of_experts)
add_subdirectory(all_reduce)
add_subdirectory(permute)
add_subdirectory(alibi)
add_subdirectory(gptq_marlin)
add_subdirectory(concat)
add_subdirectory(blockwise_gemm)
add_subdirectory(moe)
add_subdirectory(deepgemm_aot_wrapper)
add_subdirectory(flash_mla)
add_subdirectory(grouped_topk)
add_subdirectory(machete)
add_subdirectory(moe_wna16)
add_subdirectory(fused_moe_gptq_int4_fp8_kernel)
add_subdirectory(fused_add_norm)
add_subdirectory(per_token_group_quant)
add_subdirectory(split)
add_subdirectory(identity)

if(SM VERSION_GREATER_EQUAL "90")
  add_subdirectory(decode_grouped_att_m_fwd)
  add_subdirectory(fused_moe)
  add_subdirectory(fused_moe_kernel_gptq_awq)
  add_subdirectory(decode_softmax_reducev_fwd)
endif()
add_subdirectory(marlin_moe)
